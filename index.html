<!DOCTYPE html>
<html>
    <head>
        <link rel = stylesheet href="format.css">
        <script src="d3.v7.js"></script>
        <title>Start Page</title>
    </head>

<body>
    <div id = title></div>
    <div id = "top"></div>
    <div id = "mid"></div>


    <script type = "module">
        let water = await d3.csv("Midden_Oakwoods_Data_Water.csv"); 
        let soil = await d3.csv("Midden_Oakwoods_Data_Soil.csv"); 
        let images = ["ColdWater", "ParkDistrict", "Provider"];
        let cvs_files = ["water", "soil"]
        let data_list = [water, soil]
        
        console.log(water[0]) 
        
        //Header --------------------------------------------------------------------------------------------------------------------
        let imgs = d3.select('#title')
                      .append('header')
                      .text("Oakwoods Nature Preserve Water Restoration Project")

        // Add Footer Images --------------------------------------------------------------------------------------------------------
        imgs.select('#mid')
              .append('footer')
              .append('nav')
              .data(images)
              .join('img')
              .attr('class', 'imgs')
              .attr('src', (d) => "Images/" + d + ".png")
              .attr('alt', (d) => d)

        // Add navigation buttons ----------------------------------------------------------------------------------------------------
        let navbar = d3.select("#top");
        navbar.append('nav')
              .attr('class', 'navbar')
              .append('ul')
        
        let nav_btns = navbar.selectAll('ul')

        nav_btns.selectAll()
                .data(cvs_files)
                .join('li')
                .attr('class', 'navbar')
        
        nav_btns.selectAll('li')
                .join("label")
                .append('a')
                .text((d)=>d)

        // Add Map ----------------------------------------------------------------------------------------------------------------
        let map = d3.select('#mid')
        map.append('section')
            .attr('class', 'map')

        map.select('section')
            .append('img')
            .attr('class', 'map')
            .attr('src', 'Maps/map1.png')
            .attr('style', 'max-width:100%')
            .attr('usemap', 'work')

        map.select('section')
            .append('img')
            .attr('class', 'map')
            .attr('src', 'Maps/map2.png')
            .attr('style', 'max-width:100%')
            .attr('usemap', 'work')

        // Add Simple graphs -------------------------------------------------------------------------------------------------------
        const graph = d3.select('#mid')
        graph.append('section')
                  .attr('class', 'graph')
        
        var svg = graph.append('svg')
                        .attr('width', 500)
                        .attr('height', 500)

        

        // find date
        // inputs: data
        // returns: an array that holds three array containing all the year, months and days
        function find_date(data){
            let years = []
            let months = []
            let days = []
            for(var i = 0; i < data.length; i++){
                let date = data[i].visitDate.substring(0,4) + "-" 
                         + data[i].visitDate.substring(4, 6) + "-" 
                         + data[i].visitDate.substring(6,8)
                    years.push(new Date(date))
            }
            return years
        }

        let dates = find_date(water)
        
        let min_date = d3.min(dates)
        let max_date = d3.max(dates)
        
        let x = d3.scaleTime()
                    .domain([min_date, max_date])
                    .range([10, 400])
        console.log(x)
        
        svg.append("g")
            .attr("transform", `translate(0,30)`)
            .call(d3.axisBottom(x))
        
        mid.append(svg.node())
     </script>
</body>
</html>